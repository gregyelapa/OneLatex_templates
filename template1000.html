<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>OneLatex template</title>
        <script>
                async function copyToClipboard() {

                        const CBstring = document.getElementById('CBstring').innerHTML;
                        console.log(CBstring);
                        copyHtmlToClipboard(CBstring);
                        // await navigator.clipboard.write([new ClipboardItem({
                        //        'text/html': new Blob([CBstring], { type: 'text/html' })
                        // })]);
                }

                async function copyHtmlToClipboard(html) {
                        // Copy HTML content as plain text
                        await navigator.clipboard.writeText(html);

                        // Remove the internet address from the HTML content
                        const modifiedHtml = html.replace(/<a[^>]+>[^<]*<\/a>/g, ''); // Remove <a> tags and their content

                        // Copy the modified HTML content to clipboard with custom format
                        const blob = new Blob([modifiedHtml], { type: 'text/html' });
                        const clipboardItem = new ClipboardItem({ 'text/html': blob });
                        await navigator.clipboard.write([clipboardItem]);
                }
        </script>
</head>

<body>
        <!-- This is an template for OneLatex that can be copied into the clipboard and pasted in OneNote -->
        <button onclick="copyToClipboard()">Copy to Clipboard</button>
        <div id="CBstring">
                <p style="margin:0in;font-family:Calibri;font-size:11.0pt"><span
                                style="background:#FFC000">\usepackage[a4paper,hmargin=3cm,vmargin=3cm]{geometry}</span>
                </p>

                <p style="margin:0in;font-family:Calibri;font-size:11.0pt"><span
                                style="background:#FFC000">\usepackage[utf8]{inputenc}</span></p>

                <p style="margin:0in;font-family:Calibri;font-size:11.0pt"><span
                                style="background:#FFC000">\usepackage[T1]{fontenc}</span></p>

                <p style="margin:0in;font-family:Calibri;font-size:11.0pt"><span
                                style="background:#FFC000">\usepackage[english]{babel}</span></p>
        </div>

</body>

</html>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>OneLatex Package Generator for OneNote</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%237719AA'/%3E%3Ctext x='50%25' y='50%25' font-family='Arial' font-size='20' fill='white' text-anchor='middle' dominant-baseline='middle' font-weight='bold'%3EL%3C/text%3E%3C/svg%3E">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #F4F4F4;
            color: #1D1D1D;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        @keyframes slideUp {
            from {
                top: 20px;
                opacity: 1;
            }
            to {
                top: -50px;
                opacity: 0;
            }
        }
        h1 {
            color: #7719AA;
        }
        p {
            font-size: 1.1em;
            color: #4D4351;
        }
        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
        }
        th, td {
            padding: 15px;
            text-align: left;
        }
        th {
            background-color: #5FBAAF;
            color: white;
            font-weight: bold;
        }
        td {
            border-bottom: 1px solid #E0E0E0;
        }
        a {
            color: #7719AA;
            font-weight: bold;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        tr:nth-child(even) {
            background-color: #F9F9F9;
        }
        .container {
            max-width: 900px;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Stil f√ºr die Buttons */
        button {
            background-color: #7719AA; /* Prim√§rfarbe */
            color: white;
            font-size: 16px;
            border: none;
            padding: 10px 15px;
            margin: 10px 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #5FBAAF; /* Sekund√§rfarbe */
        }

        /* Link in Buttons */
        button a {
            color: white;
            text-decoration: none;
        }

        button a:hover {
            text-decoration: underline;
        }

        /* Container f√ºr bessere Struktur */
        .container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            text-align: center;
        }

        /* Stil f√ºr den Code-Block */
        .copy-content {
            background-color: #ffe8ff; /* Leicht rosa Hintergrund aus deiner Palette */
            padding: 20px;
            margin-top: 20px;
            border-radius: 5px;
            font-family: "Courier New", monospace;
            text-align: left;
        }

        /* Benachrichtigung f√ºr erfolgreiches/fehlgeschlagenes Kopieren */
        .notification {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 10000;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                top: -50px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }

        /* Erfolgreiches Kopieren */
        .success {
            background-color: #5FBAAF; /* Sekund√§rfarbe */
            color: white;
        }

        /* Fehlgeschlagenes Kopieren */
        .error {
            background-color: #AB791A; /* Goldbraune Farbe aus Palette */
            color: white;
        }

        .info-box {
            background-color: #F4F4F4; /* Helles Grau aus deiner Palette */
            border-left: 5px solid #7719AA; /* Prim√§rfarbe f√ºr visuelle Abgrenzung */
            color: #333333;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-size: 16px;
            text-align: left;
            line-height: 1.6;
        }
        
        .info-box ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        
        .info-box li {
            margin: 5px 0;
        }
    </style>
    <script>
        let selectedLanguage = "english"; // Globale Variable f√ºr die Sprache
        let selectedCategory = "all"; // Globale Variable f√ºr die Filterung

        const latexTemplates = [
            {
                title: "Basic Setup",
                category: "core-packages",
                description: "Essential packages for professional LaTeX documents. These packages form the foundation of any well-structured document:<ul><li><strong>geometry</strong>: Sets A4 paper size with 3cm margins for optimal readability</li><li><strong>inputenc/fontenc</strong>: UTF-8 and T1 encoding ensure proper character display and hyphenation</li><li><strong>babel/csquotes</strong>: Provides language-specific typography rules and correct quotation marks</li><li><strong>graphicx</strong>: Enables inclusion of images in various formats</li><li><strong>hyperref</strong>: Creates clickable links with customized colors (blue for URLs, black for internal). The <strong>urlstyle{same}</strong> command ensures that links are displayed in the same style as the rest of the text instead of the default mono-spaced font</li><li><strong>varioref/cleveref</strong>: Intelligent cross-references that automatically include page numbers</li></ul>Together, these packages ensure your document has proper encoding, typography, and navigation features. For detailed varioref/cleveref usage, see the <a href='https://www.notion.so/Cross-Referencing-26f970f1f6cc4888a34316bb62f68b76?source=copy_link#45e93c42080c4501ab20549ada4c6192' target='_blank'>Cross-Referencing section in the OneLatex Manual</a>.",
                languages: {
                    "english": [
                        "\\usepackage[a4paper,hmargin=3cm,vmargin=3cm]{geometry}",
                        "\\usepackage[utf8]{inputenc}",
                        "\\usepackage[T1]{fontenc}",
                        "\\usepackage[english]{babel}",
                        "\\usepackage{csquotes}",
                        "\\usepackage{graphicx}",
                        "\\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue, filecolor=black]{hyperref}",
                        "\\urlstyle{same}",
                        "\\usepackage[english]{varioref}",
                        "\\usepackage[noabbrev,english]{cleveref}"
                    ],
                    "german": [
                        "\\usepackage[a4paper,hmargin=3cm,vmargin=3cm]{geometry}",
                        "\\usepackage[utf8]{inputenc}",
                        "\\usepackage[T1]{fontenc}",
                        "\\usepackage[ngerman]{babel}",
                        "\\usepackage{csquotes}",
                        "\\usepackage{graphicx}",
                        "\\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue, filecolor=black]{hyperref}",
                        "\\urlstyle{same}",
                        "\\usepackage[ngerman]{varioref}",
                        "\\usepackage[noabbrev,german]{cleveref}"
                    ]
                },
                selectedLanguage: "english"
            },
            {
                title: "General Appearance",
                category: "appearance",
                description: "Packages for modern document appearance that enhance readability and visual appeal:<ul><li><strong>parskip</strong>: Removes paragraph indentation and adds vertical space between paragraphs for cleaner text flow</li><li><strong>lmodern</strong>: Provides scalable Latin Modern fonts that remain crisp at any size</li><li><strong>setspace</strong>: Sets 1.5 line spacing (onehalfspacing) for improved readability</li><li><strong>pifont</strong>: Adds special symbols like checkmarks, arrows, and decorative elements</li></ul>These packages work together to create clean, professional-looking documents with modern typography that's easier on the eyes.",
                commands: [
                    "\\usepackage{parskip}",
                    "\\usepackage{lmodern}",
                    "\\usepackage[onehalfspacing]{setspace}",
                    "\\usepackage{pifont}"
                ]
            },
            {
                title: "Colors and Frames",
                category: "appearance",
                description: "Tools for colors and visual emphasis in your documents:<ul><li><strong>xcolor</strong>: Extensive color support with table and xcdraw options for text, backgrounds, and table cells</li><li><strong>framed</strong>: Creates framed environments for highlighting important content</li><li><strong>definecolor</strong>: Defines a custom light blue shade (RGB 0.7, 0.85, 1) for the shaded environment</li></ul>Perfect for creating visually distinct sections like theorems, definitions, warnings, or any content that needs to stand out from the main text.",
                commands: [
                    "\\usepackage[table,xcdraw]{xcolor}",
                    "\\usepackage{framed}",
                    "\\definecolor{shadecolor}{rgb}{0.7,0.85,1}"
                ]
            },
            {
                title: "Pagination Control",
                category: "appearance",
                description: "Prevents poor page breaks by setting maximum penalties (10000) for widow and orphan control:<ul><li><strong>clubpenalty</strong>: Prevents page break after the first line of a paragraph</li><li><strong>widowpenalty</strong>: Prevents page break before the last line of a paragraph</li><li><strong>displaywidowpenalty</strong>: Protects displayed equations from being split</li></ul>These settings ensure that paragraphs and mathematical displays remain visually cohesive across page boundaries, eliminating unsightly isolated lines.",
                commands: [
                    "\\clubpenalty = 10000",
                    "\\widowpenalty = 10000",
                    "\\displaywidowpenalty = 10000"
                ]
            },
            {
                title: "Line Breaking Adjustments",
                category: "appearance",
                description: "Adds 2em of emergency stretch space between words when LaTeX struggles with line breaking. This prevents text from extending into margins (overfull boxes), particularly useful for documents with narrow columns, long URLs, or technical terms that resist hyphenation. The 2em value provides a good balance between typography and practicality.",
                commands: [
                    "\\setlength{\\emergencystretch}{2em}"
                ]
            },
            {
                title: "Table Packages",
                category: "tables",
                description: "Essential packages for professional table creation and formatting:<ul><li><strong>array</strong>: Extends basic tables with enhanced column types and improved spacing control</li><li><strong>tabularx</strong>: Creates tables that automatically fit page width with flexible X columns</li><li><strong>longtable</strong>: Enables multi-page tables with automatic breaks and repeating headers</li></ul>Together, these packages handle everything from simple formatted tables to complex multi-page data presentations with dynamic widths.",
                commands: [
                    "\\usepackage{array}",
                    "\\usepackage{tabularx}",
                    "\\usepackage{longtable}"
                ]
            },
            {
                title: "PDF Integration",
                category: "pdf",
                description: "Comprehensive PDF handling capabilities for LaTeX documents:<ul><li><strong>pdfpages</strong>: Insert entire PDF documents or selected pages directly into your document</li><li><strong>pdflscape</strong>: Switch to landscape orientation for specific pages within your document</li></ul>Ideal for including appendices, certificates, scanned documents, or wide tables/figures that need extra horizontal space.",
                commands: [
                    "\\usepackage{pdfpages}",
                    "\\usepackage{pdflscape}"
                ]
            },
            {
                title: "Bibliography",
                category: "bibliography",
                description: "Modern bibliography management using biblatex with biber backend. The numeric-comp style creates compressed citations ([1-3] instead of [1,2,3]) for cleaner references. Offers full Unicode support, customizable styles, and intelligent data processing. Perfect for academic papers, theses, and technical documents requiring professional citation management.",
                commands: [
                    "\\usepackage[backend=biber, style=numeric-comp]{biblatex}"
                ]
            },
            {
                title: "Section Numbering Depth",
                category: "four-five-level",
                description: "Extends automatic numbering to paragraph and subparagraph levels, which are normally unnumbered. Creates up to 5 numbered hierarchy levels (section through subparagraph), essential for technical documentation, detailed reports, or legal documents where fine-grained section referencing is required. Works seamlessly with the paragraph redefinitions below.",
                commands: [
                    "\\setcounter{secnumdepth}{5}"
                ]
            },
            {
                title: "Redefining Paragraphs",
                category: "four-five-level",
                description: "Customizes cleveref package to use consistent terminology across all section levels. Changes references to paragraphs/subparagraphs from 'paragraph' to 'Section' (English) or 'Abschnitt' (German). This ensures that \\cref commands produce natural-looking text like 'Section 2.3.1' instead of 'paragraph 2.3.1', maintaining consistency throughout your document.",
                commands: [
                    "\\makeatletter",
                    "\\renewcommand\\paragraph{\\@startsection{paragraph}{3}{0mm}{-\\baselineskip}{.1\\baselineskip}{\\normalfont\\normalsize\\bfseries}}",
                    "\\renewcommand\\subparagraph{\\@startsection{subparagraph}{4}{0mm}{-\\baselineskip}{.1\\baselineskip}{\\normalfont\\normalsize\\bfseries}}",
                    "\\makeatother"
                ]
            },
            {
                title: "Crefname Adjustments",
                category: "four-five-level",
                description: "Redefines paragraph and subparagraph formatting for consistency with other section levels:<ul><li>Text starts on a new line instead of continuing inline</li><li>Bold headings (\\bfseries) for clear visual hierarchy</li><li>Left-aligned with no indentation, matching standard sections</li><li>Proper spacing before and after headings</li></ul>Creates a uniform heading structure throughout your document, making all hierarchy levels behave consistently.",
                languages: {
                    "english": [
                        "\\crefname{paragraph}{Section}{Sections}",
                        "\\crefname{subparagraph}{Section}{Sections}"
                    ],
                    "german": [
                        "\\crefname{paragraph}{Abschnitt}{Abschnitte}",
                        "\\crefname{subparagraph}{Abschnitt}{Abschnitte}"
                    ]
                },
                selectedLanguage: "english"
            }
        ];

        function generateContent() {
            const container = document.getElementById("content-container");
            container.innerHTML = "";

            latexTemplates.filter(template => selectedCategory === "all" || template.category === selectedCategory)
                .forEach((template, index) => {
                    let contentHTML = "";
                    if (template.languages) {
                        const selectedCommands = template.languages[selectedLanguage] || [];
                        contentHTML = `
                            <div class="info-box">
                                ‚ÑπÔ∏è <strong>${template.title}</strong><br>
                                ${template.description}
                            </div>
                            <div class="copy-content" id="CBstring${index}">
                                ${selectedCommands.map(cmd => `<p style="margin:0;font-family:Calibri;font-size:11.0pt"><span style="background:#FFC000">${cmd}</span></p>`).join('')}
                            </div>
                            <button onclick="copyToClipboard('CBstring${index}')">Copy Packages in This Section to Clipboard</button>
                        `;
                    } else {
                        const commands = template.commands || [];
                        contentHTML = `
                            <div class="info-box">
                                ‚ÑπÔ∏è <strong>${template.title}</strong><br>
                                ${template.description}
                            </div>
                            <div class="copy-content" id="CBstring${index}">
                                ${commands.map(cmd => `<p style="margin:0;font-family:Calibri;font-size:11.0pt"><span style="background:#FFC000">${cmd}</span></p>`).join('')}
                            </div>
                            <button onclick="copyToClipboard('CBstring${index}')">Copy Packages in This Section to Clipboard</button>
                        `;
                    }
                    container.innerHTML += contentHTML;
                });
        }

        function updateLanguage() {
            selectedLanguage = document.getElementById("global-lang-select").value;
            generateContent();
        }

        function updateFilter() {
            selectedCategory = document.getElementById("filter-select").value;
            generateContent();
        }

        async function copyAllToClipboard() {
            try {
                const elements = document.querySelectorAll(".copy-content");
                let copiedContent = "";

                elements.forEach(el => {
                    copiedContent += el.innerHTML + "<br>"; // F√ºgt HTML-Inhalt jedes Elements hinzu
                });

                await navigator.clipboard.write([
                    new ClipboardItem({ 'text/html': new Blob([copiedContent], { type: 'text/html' }) })
                ]);

                showNotification("‚úÖ All filtered LaTeX packages copied successfully!", "success");
            } catch (err) {
                showNotification("‚ùå Error copying LaTeX packages!", "error");
            }
        }

        async function copyToClipboard(idTemplate) {
            try {
                const CBstring = document.getElementById(idTemplate).innerHTML;
                await navigator.clipboard.write([new ClipboardItem({ 'text/html': new Blob([CBstring], { type: 'text/html' }) })]);
                showNotification("‚úÖ Text copied successfully!", "success");
            } catch (err) {
                showNotification("‚ùå Error copying text!", "error");
            }
        }

        function showNotification(message, type) {
            const notification = document.getElementById("notification");
            notification.textContent = message;
            notification.className = type;
            notification.style.display = "block";
            
            // Animation beim Ausblenden
            setTimeout(() => {
                notification.style.animation = "slideUp 0.3s ease-in";
                setTimeout(() => {
                    notification.style.display = "none";
                    notification.style.animation = "slideDown 0.3s ease-out";
                }, 300);
            }, 2700);
        }
    </script>
</head>

<body onload="generateContent()">
    <div id="notification" class="notification"></div>
    <div class="container" style="position: relative;">
        <!-- Close Button innerhalb des Containers rechts oben -->
        <button id="returnButton" class="btn btn-primary" onclick="closeOrRedirect()"
            style="position: absolute; top: 10px; right: 10px; z-index: 1000;">
            <span id="buttonText">Close</span>
        </button>

        <h1>OneLatex Package Generator for OneNote</h1>
        
        <!-- Neue visuelle Einheit f√ºr die drei Elemente -->
        <div style="background-color: #f8f9fa; border: 2px solid #7719AA; border-radius: 10px; padding: 25px; margin: 20px auto; max-width: 600px; box-shadow: 0 3px 10px rgba(119, 25, 170, 0.1);">
            <p style="margin-top: 0;">Click the button below to copy the template and paste it into OneNote.</p>

            <div class="d-flex flex-column align-items-center">
                <button class="btn btn-secondary btn-lg" onclick="copyAllToClipboard()">Copy All Filtered LaTeX Packages to Clipboard</button>
            </div>

            <p style="margin-bottom: 0; margin-top: 20px; background-color: #F4F4F4; padding: 15px; border-left: 5px solid #7719AA; border-radius: 5px; font-size: 16px;">
                üí° <strong>Quick Tip:</strong> For an easy start, click the <em>"Copy All Filtered LaTeX Packages to Clipboard"</em> button
                above and paste the recommended LaTeX packages onto the first page of your OneNote notebook. These are best
                practice settings to get you going quickly.
            </p>
        </div>

        <label for="filter-select">Filter:</label>
        <select id="filter-select" onchange="updateFilter()">
            <option value="all" selected>All</option>
            <option value="core-packages">Core Packages</option>
            <option value="appearance">Appearance</option>
            <option value="tables">Tables</option>
            <option value="pdf">PDF-Integration</option>
            <option value="bibliography">Bibliography</option>
            <option value="four-five-level">paragraph and subparagraph</option>
        </select>

        <label for="global-lang-select">Select language:</label>
        <select id="global-lang-select" onchange="updateLanguage()">
            <option value="english" selected>English</option>
            <option value="german">Deutsch</option>
        </select>

        <div id="notification" class="notification"></div>
        <div id="content-container"></div>
    </div>
    <!-- JavaScript for button behavior -->
    <script>
        function closeOrRedirect() {
            const button = document.getElementById('returnButton');
            const buttonText = document.getElementById('buttonText');

            // Disable the button to prevent multiple clicks
            button.disabled = true;

            // Add spinner and update button text
            buttonText.innerHTML = `
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Returning...
      `;

            // Attempt to close the window
            window.close();

            // Fallback: Redirect to homepage if window.close() is blocked
            setTimeout(() => {
                window.location.href = '/index.html';
            }, 500);
        }
    </script>
</body>

</html>    